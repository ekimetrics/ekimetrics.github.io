"use strict";(self.webpackChunkeki_lab=self.webpackChunkeki_lab||[]).push([[3017],{3905:(e,a,t)=>{t.d(a,{Zo:()=>m,kt:()=>f});var n=t(67294);function i(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function o(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function r(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?o(Object(t),!0).forEach((function(a){i(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function s(e,a){if(null==e)return{};var t,n,i=function(e,a){if(null==e)return{};var t,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)t=o[n],a.indexOf(t)>=0||(i[t]=e[t]);return i}(e,a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)t=o[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var l=n.createContext({}),d=function(e){var a=n.useContext(l),t=a;return e&&(t="function"==typeof e?e(a):r(r({},a),e)),t},m=function(e){var a=d(e.components);return n.createElement(l.Provider,{value:a},e.children)},u="mdxType",c={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},p=n.forwardRef((function(e,a){var t=e.components,i=e.mdxType,o=e.originalType,l=e.parentName,m=s(e,["components","mdxType","originalType","parentName"]),u=d(t),p=i,f=u["".concat(l,".").concat(p)]||u[p]||c[p]||o;return t?n.createElement(f,r(r({ref:a},m),{},{components:t})):n.createElement(f,r({ref:a},m))}));function f(e,a){var t=arguments,i=a&&a.mdxType;if("string"==typeof e||i){var o=t.length,r=new Array(o);r[0]=p;var s={};for(var l in a)hasOwnProperty.call(a,l)&&(s[l]=a[l]);s.originalType=e,s[u]="string"==typeof e?e:i,r[1]=s;for(var d=2;d<o;d++)r[d]=t[d];return n.createElement.apply(null,r)}return n.createElement.apply(null,t)}p.displayName="MDXCreateElement"},47232:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>l,contentTitle:()=>r,default:()=>c,frontMatter:()=>o,metadata:()=>s,toc:()=>d});var n=t(87462),i=(t(67294),t(3905));const o={slug:"Multimodal_fusion",title:"Multimodal Deep Learning",authors:["francois.guerillon"],header_image_url:"img/blog/multimodal_fusion.jpg",image:"img/blog/multimodal_fusion.jpg",tags:["data science","deep learning","multimodal"],draft:!1,description:"Understand why multimodal deep learning models are more accurate than assembled unimodal models.",keywords:["data science","deep learning","multimodal","transfer learning","fine tuning","fusion encoder","dual encoder","natural language processing","computer vision","classification"]},r=void 0,s={permalink:"/blog/Multimodal_fusion",source:"@site/blog/2024-04-29-Multimodal_fusion.md",title:"Multimodal Deep Learning",description:"Understand why multimodal deep learning models are more accurate than assembled unimodal models.",date:"2024-04-29T00:00:00.000Z",formattedDate:"April 29, 2024",tags:[{label:"data science",permalink:"/blog/tags/data-science"},{label:"deep learning",permalink:"/blog/tags/deep-learning"},{label:"multimodal",permalink:"/blog/tags/multimodal"}],readingTime:8.335,hasTruncateMarker:!0,authors:[{name:"Fran\xe7ois GUERILLON",title:"Multimodal Specialist",url:"https://www.linkedin.com/in/fguerillon/",imageURL:"/img/authors/francois_guerillon.jpg",key:"francois.guerillon"}],frontMatter:{slug:"Multimodal_fusion",title:"Multimodal Deep Learning",authors:["francois.guerillon"],header_image_url:"img/blog/multimodal_fusion.jpg",image:"img/blog/multimodal_fusion.jpg",tags:["data science","deep learning","multimodal"],draft:!1,description:"Understand why multimodal deep learning models are more accurate than assembled unimodal models.",keywords:["data science","deep learning","multimodal","transfer learning","fine tuning","fusion encoder","dual encoder","natural language processing","computer vision","classification"]},nextItem:{title:"Uncertainty in time series forecasting",permalink:"/blog/Uncertainty_TS"}},l={authorsImageUrls:[void 0]},d=[{value:"Multimodal data is everywhere",id:"multimodal-data-is-everywhere",level:2},{value:"A multimodal brain is better than several unimodal brains",id:"a-multimodal-brain-is-better-than-several-unimodal-brains",level:2},{value:"Unimodal embeddings are not all you need",id:"unimodal-embeddings-are-not-all-you-need",level:2},{value:"A demonstration by Ekimetrics",id:"a-demonstration-by-ekimetrics",level:2},{value:"What about tabular data and time series?",id:"what-about-tabular-data-and-time-series",level:2}],m={toc:d},u="wrapper";function c(e){let{components:a,...o}=e;return(0,i.kt)(u,(0,n.Z)({},m,o,{components:a,mdxType:"MDXLayout"}),(0,i.kt)("div",{align:"justify"},(0,i.kt)("h1",{id:"part-1-why-we-use-fusion-weapon"},"Part 1: Why we use fusion weapon")),(0,i.kt)("div",{align:"center"},(0,i.kt)("p",null,"  ",(0,i.kt)("img",{alt:"screenshot-app ",src:t(46775).Z,width:"767",height:"607"}))),(0,i.kt)("br",null),(0,i.kt)("div",{align:"justify"},(0,i.kt)("p",null,"Data science (and specifically machine learning) is often seen as made up of different fields of expertise and research: \xab\u202fclassical\u202f\xbb machine learning (on tabular data), time series analysis & forecasting, computer vision, natural language processing\u2026 Indeed, each kind of (input or output) data, which we call ",(0,i.kt)("strong",{parentName:"p"},"modality")," \u2013 e.g. image, text, time series \u2013, has specific properties, raises specific challenges, and therefore requires dedicated solutions and evaluation methods. A pastry chef may ignore how to cook a black truffle risotto; a renowned ophthalmologist may deny any knowledge on kidney function; as well, in a siloed view of data science, a computer vision expert might pay no attention to the latest advances in gradient boosting or large language models. "),(0,i.kt)("p",null,"At ",(0,i.kt)("strong",{parentName:"p"},"Ekimetrics"),", we have abandoned that siloed view: useful and meaningful data often is multimodal, and leveraging the predictive or generative power of several modalities cannot just be a matter of stacking or superficially connecting each field\u2019s solutions. Let us see why this is important. ")),(0,i.kt)("h2",{id:"multimodal-data-is-everywhere"},"Multimodal data is everywhere"),(0,i.kt)("div",{align:"justify"},(0,i.kt)("p",null,"In many fields of economy and science, data is multimodal, and each modality may contain useful information. Multimodality is not just a theoretic use case! Let us provide three examples: "),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot-app ",src:t(49320).Z,width:"650",height:"746"})),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Product databases (manufacturing, retail, tourism, real estate\u2026) may contain tabular data, product descriptions or other textual information, product photos, time series for price or sales history\u2026 Each product has multimodal data. Each modality contains potential predictive information, for instance to forecast future demand or sales."),(0,i.kt)("li",{parentName:"ul"},"Medical records include textual documents, tabular data, images, regular or irregular time series. Here again, for each patient, every modality may contain precious information to help diagnosis or prognosis."),(0,i.kt)("li",{parentName:"ul"},"Advertisements, e-mails, newspaper covers and articles and social media posts are usually bimodal: texts combined with one or several images (and sometimes, texts within images). Both modalities surely have an influence on the impact (clicks, \u201clikes\u201d, sales\u2026) of these signals, and should be addressed when predicting this impact.")),(0,i.kt)("p",null,"This is why, in our job as data scientists, we must design and implement the best solutions to harness combined data modalities.")),(0,i.kt)("h2",{id:"a-multimodal-brain-is-better-than-several-unimodal-brains"},"A multimodal brain is better than several unimodal brains"),(0,i.kt)("div",{align:"justify"},(0,i.kt)("p",null,"Every minute or even second, our human brain reacts, evaluates, and makes decisions after combining and processing several signals of different kinds, gathered from several senses. Each sense (or each modality) is correctly interpreted ",(0,i.kt)("strong",{parentName:"p"},"thanks to the knowledge of all other signals"),":"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"To know if the noise I heard on my right reveals a danger, I must concentrate my vision sense to the same direction (maybe turn my head) and look at the source of the noise."),(0,i.kt)("li",{parentName:"ul"},"Imagine that someone shows me a document and gives oral explanations. Something sounds weird in these explanations. To know if my interlocutor is serious or joking, I must stop looking at the document, and look at his/her facial expression."),(0,i.kt)("li",{parentName:"ul"},"To select what to pay attention to in this ",(0,i.kt)("a",{parentName:"li",href:"https://www.youtube.com/watch?v=KB_lTKZm1Ts"},"famous awareness test"),", I must know and understand the written instructions (or game rule)."),(0,i.kt)("li",{parentName:"ul"},"As a specialist physician, to avoid missing weak signals in exam results (imagery, blood test history\u2026) and symptoms, I must understand why the patient was sent to me, which means reading the cover letter or medical report, so as to know what to focus on."),(0,i.kt)("li",{parentName:"ul"},"In many bimodal documents, for instance scientifical articles, understanding the images (diagrams, charts) help understanding the text, and reading some texts (e.g. captions) can be necessary to understand the images or to deduce what is important to be watched in the image.")),(0,i.kt)("p",null,"If all these examples, suppose each modality is observed by a different person (a different unimodal brain), without any communication with the other persons, and afterwards, only afterwards, these persons can communicate and decide, without any access to the modalities. What will happen? They will probably miss something, because they did not look in the right direction, or did not focus enough on some detail, or misinterpreted a signal.")),(0,i.kt)("div",{align:"center"},(0,i.kt)("p",null,(0,i.kt)("img",{alt:"screenshot-app ",src:t(19039).Z,width:"395",height:"270"})),(0,i.kt)("p",null,"What if the neurons are artificial ones?")),(0,i.kt)("h2",{id:"unimodal-embeddings-are-not-all-you-need"},"Unimodal embeddings are not all you need"),(0,i.kt)("div",{align:"justify"},(0,i.kt)("p",null,"In simple (or maybe naive) multimodal deep learning architectures, unimodal state-of-the-art (SoTA) neural networks work independently. Each unimodal brain classically produces a ",(0,i.kt)("strong",{parentName:"p"},"unimodal embedding"),", which is usually a vector (1D-array) or a sequence of vectors (2D-array) of numerical values, which is supposed to concentrate all useful information on the modality, in a reduced mathematical space. Then, a prediction is built from all these gathered embeddings, thanks to the addition of a few more trained neural layers (a \u201chead\u201d block), or with numerical machine learning solutions such as tree boosting. It looks SoTA, but it often induces poor performance."),(0,i.kt)("p",null,"The first reason is that each unimodal embedding is given in a different latent space: it means that it uses a language which is completely different from the other unimodal embeddings. Thus, the image embedding does not help guessing what is important to check in the text embedding, and vice versa. In the human scenario (unimodal brains), it would be as if the involved persons could not communicate correctly together: making a good decision would be quite unlikely."),(0,i.kt)("p",null,"Fortunately, public pre-trained models and architectures called ",(0,i.kt)("strong",{parentName:"p"},"dual encoders"),", like CLIP",(0,i.kt)("sup",{parentName:"p",id:"fnref-1-8a5312"},(0,i.kt)("a",{parentName:"sup",href:"#fn-1-8a5312",className:"footnote-ref"},"1"))," , can produce text embeddings and image embeddings in the same latent space (same language), which significantly helps bridging the gap between modalities, and improve predictive performance."),(0,i.kt)("p",null,"But this is not enough. You already know the second reason: even with dual encoders, each unimodal brain (network) does not communicate with the other brains when analyzing its modality, and therefore, does not focus enough on what is important in it. This is why a new family of multimodal models has been designed: ",(0,i.kt)("strong",{parentName:"p"},"fusion encoders"),". They allow, in each modality analysis, to progressively introduced useful information from other modalities. Thus, useful information is jointly extracted from all modalities of a same data sample."),(0,i.kt)("p",null,"Pretrained image & text (bimodal) fusion encoders, ingeniously assembling SoTA expertise of both computer vision and natural language processing, are now publicly available: ViLT",(0,i.kt)("sup",{parentName:"p",id:"fnref-2-8a5312"},(0,i.kt)("a",{parentName:"sup",href:"#fn-2-8a5312",className:"footnote-ref"},"2"))," , FLAVA",(0,i.kt)("sup",{parentName:"p",id:"fnref-3-8a5312"},(0,i.kt)("a",{parentName:"sup",href:"#fn-3-8a5312",className:"footnote-ref"},"3"))," , BLIP",(0,i.kt)("sup",{parentName:"p",id:"fnref-4-8a5312"},(0,i.kt)("a",{parentName:"sup",href:"#fn-4-8a5312",className:"footnote-ref"},"4"))," , BLIP-2",(0,i.kt)("sup",{parentName:"p",id:"fnref-5-8a5312"},(0,i.kt)("a",{parentName:"sup",href:"#fn-5-8a5312",className:"footnote-ref"},"5"))," \u2026 They can output ",(0,i.kt)("strong",{parentName:"p"},"bimodal embeddings"),", which contain rich relevant information from a pair {image, text}, analyzed together. They are excellent candidates for \u201ctransfer learning\u201d strategies: adding a trained \u201chead\u201d network on top of a fine-tuned fusion encoder, to make the desired prediction or forecast.")),(0,i.kt)("div",{align:"center"},(0,i.kt)("p",null,"  ",(0,i.kt)("img",{alt:"screenshot-app ",src:t(24364).Z,width:"480",height:"217"}))),(0,i.kt)("h2",{id:"a-demonstration-by-ekimetrics"},"A demonstration by Ekimetrics"),(0,i.kt)("div",{align:"justify"},(0,i.kt)("p",null,"Huge product databases sometimes suffer from insufficient or irregular quality, due to historical or heterogeneous (sometimes manual) feeding processes. For instance, an irrelevant picture (product photo) may have been associated to an unmatching product. Manual thorough detection of errors, on millions of products, would be extremely costly. At Ekimetrics Innovation Lab (Eki.Lab), we have designed, built, evaluated, and validated a deep learning solution to efficiently semi-automate that task: it can detect most mismatches between an image and the known text fields (name, properties, description, summary\u2026) of the same product."),(0,i.kt)("p",null,"Our most efficient solution mainly relies on a fine-tuned fusion encoder and trained head. Even with artificially generated hard-to-find image permutations (e.g. replacing an image with a similar but slightly different one) in test database, our solution can detect 87% (recall) of existing mismatches, with a tolerated precision of 50% (i.e. allowing that that only 1 suspicious image out of 2 is actually incorrect). On top of that, we have designed and validated a method to adapt the model to any unlabeled product database (self-supervision): costly human labelling is unnecessary."),(0,i.kt)("p",null,"Our experiments confirm that without a fusion encoder, and even using CLIP as a dual encoder, results are much worse: recall remains under 30% with the same constraint on precision.")),(0,i.kt)("div",{align:"center"},(0,i.kt)("p",null,"  ",(0,i.kt)("img",{alt:"screenshot-app ",src:t(18607).Z,width:"499",height:"263"}))),(0,i.kt)("h2",{id:"what-about-tabular-data-and-time-series"},"What about tabular data and time series?"),(0,i.kt)("div",{align:"justify"},(0,i.kt)("p",null,"Now, what would be the best solution for a predictive task in which multimodal input includes tabular data and/or time series? In most cases, there is no relevant pre-trained fusion encoder on these modalities, since there is no universal knowledge to deduce from pre-training on time series or tabular data. However, a few recent research papers, such as the Perceiver family (Perceiver",(0,i.kt)("sup",{parentName:"p",id:"fnref-6-8a5312"},(0,i.kt)("a",{parentName:"sup",href:"#fn-6-8a5312",className:"footnote-ref"},"6"))," , Perceiver IO",(0,i.kt)("sup",{parentName:"p",id:"fnref-7-8a5312"},(0,i.kt)("a",{parentName:"sup",href:"#fn-7-8a5312",className:"footnote-ref"},"7"))," , Hierarchical Perceiver",(0,i.kt)("sup",{parentName:"p",id:"fnref-8-8a5312"},(0,i.kt)("a",{parentName:"sup",href:"#fn-8-8a5312",className:"footnote-ref"},"8"))," ), show promising ways to build and train an accurate unique (fusion) deep learning model based on any combination of various modalities."),(0,i.kt)("p",null,"Combining such a \u201cmultimodal-by-design\u201d architecture with pre-trained models (including fusion encoders) for both text and images, which may still bring useful knowledge with small-sized training datasets, is an active field of research",(0,i.kt)("sup",{parentName:"p",id:"fnref-9-8a5312"},(0,i.kt)("a",{parentName:"sup",href:"#fn-9-8a5312",className:"footnote-ref"},"9"))," , in which Ekimetrics is fully involved. A high range of disruptive use cases can be designed: in the near future, efficient multimodal models will help optimize media communication, forecast demand or sales to optimize product design or supply chain, forecast or optimize prices, help diagnosis or prognosis, perform impactful social media analysis\u2026 Please stay connected for future news on the subject!")),(0,i.kt)("div",{className:"footnotes"},(0,i.kt)("hr",{parentName:"div"}),(0,i.kt)("ol",{parentName:"div"},(0,i.kt)("li",{parentName:"ol",id:"fn-1-8a5312"},"\xab Learning Transferable Visual Models From Natural Language Supervision \xbb, A. Radford et al., 2021",(0,i.kt)("a",{parentName:"li",href:"#fnref-1-8a5312",className:"footnote-backref"},"\u21a9")),(0,i.kt)("li",{parentName:"ol",id:"fn-2-8a5312"},"\xab ViLT: Vision-and-Language Transformer Without Convolution or Region Supervision \xbb, W. Kim & al., 2021",(0,i.kt)("a",{parentName:"li",href:"#fnref-2-8a5312",className:"footnote-backref"},"\u21a9")),(0,i.kt)("li",{parentName:"ol",id:"fn-3-8a5312"},"\xab FLAVA: A Foundational Language And Vision Alignment Model \xbb, A. Singh, 2022",(0,i.kt)("a",{parentName:"li",href:"#fnref-3-8a5312",className:"footnote-backref"},"\u21a9")),(0,i.kt)("li",{parentName:"ol",id:"fn-4-8a5312"},"\xab BLIP: Bootstrapping Language-Image Pre-training for Unified Vision-Language Understanding and Generation \xbb, J. Li et al., 2022",(0,i.kt)("a",{parentName:"li",href:"#fnref-4-8a5312",className:"footnote-backref"},"\u21a9")),(0,i.kt)("li",{parentName:"ol",id:"fn-5-8a5312"},"\xab BLIP-2: Bootstrapping Language-Image Pre-training with Frozen Image Encoders and Large Language Models \xbb, J. Li et al., 2023",(0,i.kt)("a",{parentName:"li",href:"#fnref-5-8a5312",className:"footnote-backref"},"\u21a9")),(0,i.kt)("li",{parentName:"ol",id:"fn-6-8a5312"},"\xab Perceiver: General Perception with Iterative Attention \xbb, A. Jaegle et al., 2021",(0,i.kt)("a",{parentName:"li",href:"#fnref-6-8a5312",className:"footnote-backref"},"\u21a9")),(0,i.kt)("li",{parentName:"ol",id:"fn-7-8a5312"},"\xab Perceiver IO : a general architecture for structured inputs & outputs \xbb, A. Jaegle et al., 2021",(0,i.kt)("a",{parentName:"li",href:"#fnref-7-8a5312",className:"footnote-backref"},"\u21a9")),(0,i.kt)("li",{parentName:"ol",id:"fn-8-8a5312"},"\xab HiP: Hierarchical Perceiver \xbb, J. Carreira et al., 2022",(0,i.kt)("a",{parentName:"li",href:"#fnref-8-8a5312",className:"footnote-backref"},"\u21a9")),(0,i.kt)("li",{parentName:"ol",id:"fn-9-8a5312"},"For instance, see \xab Flamingo: a Visual Language Model for Few-Shot Learning \xbb, J.B. Alayrac et al., 2022",(0,i.kt)("a",{parentName:"li",href:"#fnref-9-8a5312",className:"footnote-backref"},"\u21a9")))))}c.isMDXComponent=!0},49320:(e,a,t)=>{t.d(a,{Z:()=>n});const n=t.p+"assets/images/Ad_Picture-bea3732d610bfa9db711ee0282bbeb13.png"},24364:(e,a,t)=>{t.d(a,{Z:()=>n});const n=t.p+"assets/images/BLIP-a4096d65e4dda89ff8514e24d609aeb2.png"},18607:(e,a,t)=>{t.d(a,{Z:()=>n});const n=t.p+"assets/images/Fusion_encoder-761c366ece8019ab9debcfc288ef235d.png"},46775:(e,a,t)=>{t.d(a,{Z:()=>n});const n=t.p+"assets/images/Introduction-0c5bea6b0953aca320c988247d219f80.png"},19039:(e,a,t)=>{t.d(a,{Z:()=>n});const n=t.p+"assets/images/Monkeys-572eccaee87d0f6a45c2c5291997e81d.png"}}]);